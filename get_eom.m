function [J, f0] = get_eom(params, body, leg_a, leg_b)

mb = params(1); Ib = params(2); mf = params(3);
Im = params(8); b = params(9); n = params(10);
la = leg_a(3); dla = leg_a(4);
lb = leg_b(3); dlb = leg_b(4);
dthb = body(6);
dthla = leg_a(6); dthlb = leg_b(6);
dthma = dthla*n; dthmb = dthlb*n;
lxa = leg_a(11); lya = leg_a(12); lxb = leg_b(11); lyb = leg_b(12);

Itot = ((mf*Im^2*la^2 + mf*Im^2*lb^2 + Ib*Im^2)*(lxa^2*lyb^2*mf^2 + lxa^2*mb*mf - 2*lxa*lxb*lya*lyb*mf^2 + lxb^2*lya^2*mf^2 + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + mb^2))*n^4 + (-(2*mf*Im^2*la^2 + 2*mf*Im^2*lb^2)*(lxa^2*lyb^2*mf^2 + lxa^2*mb*mf - 2*lxa*lxb*lya*lyb*mf^2 + lxb^2*lya^2*mf^2 + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + mb^2))*n^3 + ((Im^2*la^2*mf + Im^2*lb^2*mf + 2*Im*la^2*lb^2*mf^2 + Ib*Im*la^2*mf + Ib*Im*lb^2*mf)*(lxa^2*lyb^2*mf^2 + lxa^2*mb*mf - 2*lxa*lxb*lya*lyb*mf^2 + lxb^2*lya^2*mf^2 + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + mb^2))*n^2 + (-4*Im*la^2*lb^2*mf^2*(lxa^2*lyb^2*mf^2 + lxa^2*mb*mf - 2*lxa*lxb*lya*lyb*mf^2 + lxb^2*lya^2*mf^2 + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + mb^2))*n + (Ib*la^2*lb^2*mf^2 + 2*Im*la^2*lb^2*mf^2)*(lxa^2*lyb^2*mf^2 + lxa^2*mb*mf - 2*lxa*lxb*lya*lyb*mf^2 + lxb^2*lya^2*mf^2 + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + mb^2);
mbtot = mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2;

J = [[0, 0, (lya*(lya*mb + lxb^2*lya*mf - lxa*lxb*lyb*mf))/mbtot, -(lxa*(lya*mb + lxb^2*lya*mf - lxa*lxb*lyb*mf))/mbtot, (lyb*(lyb*mb + lxa^2*lyb*mf - lxa*lxb*lya*mf))/mbtot, -(lxb*(lyb*mb + lxa^2*lyb*mf - lxa*lxb*lya*mf))/mbtot, 0, (mb + lxa^2*mf + lxb^2*mf)/mbtot, (mf*(lxa*lya + lxb*lyb))/mbtot];
     [0, 0, -(lya*(lxa*mb + lxa*lyb^2*mf - lxb*lya*lyb*mf))/mbtot, (lxa*(lxa*mb + lxa*lyb^2*mf - lxb*lya*lyb*mf))/mbtot, -(lyb*(lxb*mb + lxb*lya^2*mf - lxa*lya*lyb*mf))/mbtot, (lxb*(lxb*mb + lxb*lya^2*mf - lxa*lya*lyb*mf))/mbtot, 0, (mf*(lxa*lya + lxb*lyb))/mbtot, (mb + lya^2*mf + lyb^2*mf)/mbtot];
     [-(n*(Im*n + la^2*mf)*(Im*n^2 + lb^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, -(n*(Im*n + lb^2*mf)*(Im*n^2 + la^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, -(Im*lya*mb*n*(n - 1)*(la*lb^2*lxb^2*mf^2 + la*lb^2*lyb^2*mf^2 + Im*la*mb*n^2 + la*lb^2*mb*mf + Im*la*lxb^2*mf*n^2 + Im*la*lyb^2*mf*n^2 - la^2*lb*lxa*lxb*mf^2 - la^2*lb*lya*lyb*mf^2 - Im*lb*lxa*lxb*mf*n^2 - Im*lb*lya*lyb*mf*n^2))/Itot, (Im*lxa*mb*n*(n - 1)*(la*lb^2*lxb^2*mf^2 + la*lb^2*lyb^2*mf^2 + Im*la*mb*n^2 + la*lb^2*mb*mf + Im*la*lxb^2*mf*n^2 + Im*la*lyb^2*mf*n^2 - la^2*lb*lxa*lxb*mf^2 - la^2*lb*lya*lyb*mf^2 - Im*lb*lxa*lxb*mf*n^2 - Im*lb*lya*lyb*mf*n^2))/Itot, -(Im*lyb*mb*n*(n - 1)*(la^2*lb*lxa^2*mf^2 + la^2*lb*lya^2*mf^2 + Im*lb*mb*n^2 + la^2*lb*mb*mf + Im*lb*lxa^2*mf*n^2 + Im*lb*lya^2*mf*n^2 - la*lb^2*lxa*lxb*mf^2 - la*lb^2*lya*lyb*mf^2 - Im*la*lxa*lxb*mf*n^2 - Im*la*lya*lyb*mf*n^2))/Itot, (Im*lxb*mb*n*(n - 1)*(la^2*lb*lxa^2*mf^2 + la^2*lb*lya^2*mf^2 + Im*lb*mb*n^2 + la^2*lb*mb*mf + Im*lb*lxa^2*mf*n^2 + Im*lb*lya^2*mf*n^2 - la*lb^2*lxa*lxb*mf^2 - la*lb^2*lya*lyb*mf^2 - Im*la*lxa*lxb*mf*n^2 - Im*la*lya*lyb*mf*n^2))/Itot, ((Im*n^2 + la^2*mf)*(Im*n^2 + lb^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, (Im*mf*n*(n - 1)*(la*lb^2*lxb^2*lya*mf^2 + la^2*lb*lxa^2*lyb*mf^2 + Im*la*lya*mb*n^2 + Im*lb*lyb*mb*n^2 + la*lb^2*lya*mb*mf + la^2*lb*lyb*mb*mf + Im*la*lxb^2*lya*mf*n^2 + Im*lb*lxa^2*lyb*mf*n^2 - la^2*lb*lxa*lxb*lya*mf^2 - la*lb^2*lxa*lxb*lyb*mf^2 - Im*la*lxa*lxb*lyb*mf*n^2 - Im*lb*lxa*lxb*lya*mf*n^2))/Itot, -(Im*mf*n*(n - 1)*(la*lb^2*lxa*lyb^2*mf^2 + la^2*lb*lxb*lya^2*mf^2 + Im*la*lxa*mb*n^2 + Im*lb*lxb*mb*n^2 + la*lb^2*lxa*mb*mf + la^2*lb*lxb*mb*mf + Im*la*lxa*lyb^2*mf*n^2 + Im*lb*lxb*lya^2*mf*n^2 - la^2*lb*lxa*lya*lyb*mf^2 - la*lb^2*lxb*lya*lyb*mf^2 - Im*la*lxb*lya*lyb*mf*n^2 - Im*lb*lxa*lya*lyb*mf*n^2))/Itot];
     [0, 0, (lxa*mb^2 + lxa^3*mb*mf + lxa^3*lyb^2*mf^2 + lxa*lya^2*lyb^2*mf^2 + lxa*lxb^2*mb*mf + lxa*lya^2*mb*mf + lxa*lyb^2*mb*mf - lxb*lya^3*lyb*mf^2 - lxa^2*lxb*lya*lyb*mf^2)/(mf*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)), (lya*mb^2 + lya^3*mb*mf + lxb^2*lya^3*mf^2 + lxa^2*lxb^2*lya*mf^2 + lxa^2*lya*mb*mf + lxb^2*lya*mb*mf + lya*lyb^2*mb*mf - lxa^3*lxb*lyb*mf^2 - lxa*lxb*lya^2*lyb*mf^2)/(mf*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)), -(lyb*(lxa*lyb - lxb*lya)*(mb + lxa^2*mf + lya^2*mf))/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2), (lxb*(lxa*lyb - lxb*lya)*(mb + lxa^2*mf + lya^2*mf))/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2), 0, -(lxa*mb + lxa^3*mf + lxa*lxb^2*mf + lxa*lya^2*mf + lxb*lya*lyb*mf)/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2), -(lya*mb + lya^3*mf + lxa^2*lya*mf + lya*lyb^2*mf + lxa*lxb*lyb*mf)/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)];
     [(n*(Im^2*n^2 + Ib*Im*n^2 + la^2*lb^2*mf^2 + Ib*lb^2*mf + 2*Im*lb^2*mf - 2*Im*lb^2*mf*n + Im*la^2*mf*n^2 + Im*lb^2*mf*n^2)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, (n*(Im*n + la^2*mf)*(Im*n + lb^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, -(lya*mb*(Im^2*la*mb*n^2 - Im^2*la*mb*n^3 + Ib*la*lb^2*lxb^2*mf^2 + Ib*la*lb^2*lyb^2*mf^2 + 2*Im*la*lb^2*lxb^2*mf^2 + 2*Im*la*lb^2*lyb^2*mf^2 + Im^2*la*lxb^2*mf*n^2 - Im^2*la*lxb^2*mf*n^3 + Im^2*la*lyb^2*mf*n^2 - Im^2*la*lyb^2*mf*n^3 + Ib*Im*la*mb*n^2 + Ib*la*lb^2*mb*mf + 2*Im*la*lb^2*mb*mf - 3*Im*la*lb^2*mb*mf*n + Im*la*lb^2*lxb^2*mf^2*n^2 + Im*la*lb^2*lyb^2*mf^2*n^2 + Ib*Im*la*lxb^2*mf*n^2 + Ib*Im*la*lyb^2*mf*n^2 - Im^2*lb*lxa*lxb*mf*n^2 + Im^2*lb*lxa*lxb*mf*n^3 - Im^2*lb*lya*lyb*mf*n^2 + Im^2*lb*lya*lyb*mf*n^3 + Im*la*lb^2*mb*mf*n^2 - 3*Im*la*lb^2*lxb^2*mf^2*n - 3*Im*la*lb^2*lyb^2*mf^2*n + Im*la^2*lb*lxa*lxb*mf^2*n^2 + Im*la^2*lb*lya*lyb*mf^2*n^2 - Im*la^2*lb*lxa*lxb*mf^2*n - Im*la^2*lb*lya*lyb*mf^2*n))/Itot, (lxa*mb*(Im^2*la*mb*n^2 - Im^2*la*mb*n^3 + Ib*la*lb^2*lxb^2*mf^2 + Ib*la*lb^2*lyb^2*mf^2 + 2*Im*la*lb^2*lxb^2*mf^2 + 2*Im*la*lb^2*lyb^2*mf^2 + Im^2*la*lxb^2*mf*n^2 - Im^2*la*lxb^2*mf*n^3 + Im^2*la*lyb^2*mf*n^2 - Im^2*la*lyb^2*mf*n^3 + Ib*Im*la*mb*n^2 + Ib*la*lb^2*mb*mf + 2*Im*la*lb^2*mb*mf - 3*Im*la*lb^2*mb*mf*n + Im*la*lb^2*lxb^2*mf^2*n^2 + Im*la*lb^2*lyb^2*mf^2*n^2 + Ib*Im*la*lxb^2*mf*n^2 + Ib*Im*la*lyb^2*mf*n^2 - Im^2*lb*lxa*lxb*mf*n^2 + Im^2*lb*lxa*lxb*mf*n^3 - Im^2*lb*lya*lyb*mf*n^2 + Im^2*lb*lya*lyb*mf*n^3 + Im*la*lb^2*mb*mf*n^2 - 3*Im*la*lb^2*lxb^2*mf^2*n - 3*Im*la*lb^2*lyb^2*mf^2*n + Im*la^2*lb*lxa*lxb*mf^2*n^2 + Im*la^2*lb*lya*lyb*mf^2*n^2 - Im*la^2*lb*lxa*lxb*mf^2*n - Im*la^2*lb*lya*lyb*mf^2*n))/Itot, (lyb*mb*(Im^2*lb*mb*n^3 - Im^2*lb*mb*n^2 - Im^2*lb*lxa^2*mf*n^2 + Im^2*lb*lxa^2*mf*n^3 - Im^2*lb*lya^2*mf*n^2 + Im^2*lb*lya^2*mf*n^3 - Im*la^2*lb*mb*mf*n + Im*la^2*lb*lxa^2*mf^2*n^2 + Im*la^2*lb*lya^2*mf^2*n^2 + Ib*la*lb^2*lxa*lxb*mf^2 + Ib*la*lb^2*lya*lyb*mf^2 + 2*Im*la*lb^2*lxa*lxb*mf^2 + 2*Im*la*lb^2*lya*lyb*mf^2 + Im^2*la*lxa*lxb*mf*n^2 - Im^2*la*lxa*lxb*mf*n^3 + Im^2*la*lya*lyb*mf*n^2 - Im^2*la*lya*lyb*mf*n^3 + Im*la^2*lb*mb*mf*n^2 - Im*la^2*lb*lxa^2*mf^2*n - Im*la^2*lb*lya^2*mf^2*n + Im*la*lb^2*lxa*lxb*mf^2*n^2 + Im*la*lb^2*lya*lyb*mf^2*n^2 + Ib*Im*la*lxa*lxb*mf*n^2 + Ib*Im*la*lya*lyb*mf*n^2 - 3*Im*la*lb^2*lxa*lxb*mf^2*n - 3*Im*la*lb^2*lya*lyb*mf^2*n))/Itot, -(lxb*mb*(Im^2*lb*mb*n^3 - Im^2*lb*mb*n^2 - Im^2*lb*lxa^2*mf*n^2 + Im^2*lb*lxa^2*mf*n^3 - Im^2*lb*lya^2*mf*n^2 + Im^2*lb*lya^2*mf*n^3 - Im*la^2*lb*mb*mf*n + Im*la^2*lb*lxa^2*mf^2*n^2 + Im*la^2*lb*lya^2*mf^2*n^2 + Ib*la*lb^2*lxa*lxb*mf^2 + Ib*la*lb^2*lya*lyb*mf^2 + 2*Im*la*lb^2*lxa*lxb*mf^2 + 2*Im*la*lb^2*lya*lyb*mf^2 + Im^2*la*lxa*lxb*mf*n^2 - Im^2*la*lxa*lxb*mf*n^3 + Im^2*la*lya*lyb*mf*n^2 - Im^2*la*lya*lyb*mf*n^3 + Im*la^2*lb*mb*mf*n^2 - Im*la^2*lb*lxa^2*mf^2*n - Im*la^2*lb*lya^2*mf^2*n + Im*la*lb^2*lxa*lxb*mf^2*n^2 + Im*la*lb^2*lya*lyb*mf^2*n^2 + Ib*Im*la*lxa*lxb*mf*n^2 + Ib*Im*la*lya*lyb*mf*n^2 - 3*Im*la*lb^2*lxa*lxb*mf^2*n - 3*Im*la*lb^2*lya*lyb*mf^2*n))/Itot, -((Im*n + la^2*mf)*(Im*n^2 + lb^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, (Im^2*la*lxb^2*lya*mf^2*n^2 - Im^2*la*lxb^2*lya*mf^2*n^3 + Im^2*lb*lxa^2*lyb*mf^2*n^2 - Im^2*lb*lxa^2*lyb*mf^2*n^3 + Ib*la*lb^2*lya*mb*mf^2 + 2*Im*la*lb^2*lya*mb*mf^2 + Im^2*la*lya*mb*mf*n^2 - Im^2*la*lya*mb*mf*n^3 + Im^2*lb*lyb*mb*mf*n^2 - Im^2*lb*lyb*mb*mf*n^3 + Ib*la*lb^2*lxb^2*lya*mf^3 + 2*Im*la*lb^2*lxb^2*lya*mf^3 + Ib*Im*la*lxb^2*lya*mf^2*n^2 - 3*Im*la*lb^2*lxb^2*lya*mf^3*n + Im*la^2*lb*lxa^2*lyb*mf^3*n - Im^2*la*lxa*lxb*lyb*mf^2*n^2 + Im^2*la*lxa*lxb*lyb*mf^2*n^3 - Im^2*lb*lxa*lxb*lya*mf^2*n^2 + Im^2*lb*lxa*lxb*lya*mf^2*n^3 + Im*la*lb^2*lya*mb*mf^2*n^2 - Im*la^2*lb*lyb*mb*mf^2*n^2 + Ib*Im*la*lya*mb*mf*n^2 + Im*la*lb^2*lxb^2*lya*mf^3*n^2 - Im*la^2*lb*lxa^2*lyb*mf^3*n^2 - Ib*la*lb^2*lxa*lxb*lyb*mf^3 - 2*Im*la*lb^2*lxa*lxb*lyb*mf^3 - 3*Im*la*lb^2*lya*mb*mf^2*n + Im*la^2*lb*lyb*mb*mf^2*n - Ib*Im*la*lxa*lxb*lyb*mf^2*n^2 - Im*la^2*lb*lxa*lxb*lya*mf^3*n + 3*Im*la*lb^2*lxa*lxb*lyb*mf^3*n + Im*la^2*lb*lxa*lxb*lya*mf^3*n^2 - Im*la*lb^2*lxa*lxb*lyb*mf^3*n^2)/Itot, -(Im^2*la*lxa*lyb^2*mf^2*n^2 - Im^2*la*lxa*lyb^2*mf^2*n^3 + Im^2*lb*lxb*lya^2*mf^2*n^2 - Im^2*lb*lxb*lya^2*mf^2*n^3 + Ib*la*lb^2*lxa*mb*mf^2 + 2*Im*la*lb^2*lxa*mb*mf^2 + Im^2*la*lxa*mb*mf*n^2 - Im^2*la*lxa*mb*mf*n^3 + Im^2*lb*lxb*mb*mf*n^2 - Im^2*lb*lxb*mb*mf*n^3 + Ib*la*lb^2*lxa*lyb^2*mf^3 + 2*Im*la*lb^2*lxa*lyb^2*mf^3 + Ib*Im*la*lxa*lyb^2*mf^2*n^2 - 3*Im*la*lb^2*lxa*lyb^2*mf^3*n + Im*la^2*lb*lxb*lya^2*mf^3*n - Im^2*la*lxb*lya*lyb*mf^2*n^2 + Im^2*la*lxb*lya*lyb*mf^2*n^3 - Im^2*lb*lxa*lya*lyb*mf^2*n^2 + Im^2*lb*lxa*lya*lyb*mf^2*n^3 + Im*la*lb^2*lxa*mb*mf^2*n^2 - Im*la^2*lb*lxb*mb*mf^2*n^2 + Ib*Im*la*lxa*mb*mf*n^2 + Im*la*lb^2*lxa*lyb^2*mf^3*n^2 - Im*la^2*lb*lxb*lya^2*mf^3*n^2 - Ib*la*lb^2*lxb*lya*lyb*mf^3 - 2*Im*la*lb^2*lxb*lya*lyb*mf^3 - 3*Im*la*lb^2*lxa*mb*mf^2*n + Im*la^2*lb*lxb*mb*mf^2*n - Ib*Im*la*lxb*lya*lyb*mf^2*n^2 - Im*la^2*lb*lxa*lya*lyb*mf^3*n + 3*Im*la*lb^2*lxb*lya*lyb*mf^3*n + Im*la^2*lb*lxa*lya*lyb*mf^3*n^2 - Im*la*lb^2*lxb*lya*lyb*mf^3*n^2)/Itot];
     [0, 0, (lya*(lxa*lyb - lxb*lya)*(mb + lxb^2*mf + lyb^2*mf))/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2), -(lxa*(lxa*lyb - lxb*lya)*(mb + lxb^2*mf + lyb^2*mf))/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2), (lxb*mb^2 + lxb^3*mb*mf + lxb^3*lya^2*mf^2 + lxb*lya^2*lyb^2*mf^2 + lxa^2*lxb*mb*mf + lxb*lya^2*mb*mf + lxb*lyb^2*mb*mf - lxa*lya*lyb^3*mf^2 - lxa*lxb^2*lya*lyb*mf^2)/(mf*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)), (lyb*mb^2 + lyb^3*mb*mf + lxa^2*lyb^3*mf^2 + lxa^2*lxb^2*lyb*mf^2 + lxa^2*lyb*mb*mf + lxb^2*lyb*mb*mf + lya^2*lyb*mb*mf - lxa*lxb^3*lya*mf^2 - lxa*lxb*lya*lyb^2*mf^2)/(mf*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)), 0, -(lxb*mb + lxb^3*mf + lxa^2*lxb*mf + lxb*lyb^2*mf + lxa*lya*lyb*mf)/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2), -(lyb*mb + lyb^3*mf + lxb^2*lyb*mf + lya^2*lyb*mf + lxa*lxb*lya*mf)/(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)];
     [(n*(Im*n + la^2*mf)*(Im*n + lb^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, (n*(Im^2*n^2 + Ib*Im*n^2 + la^2*lb^2*mf^2 + Ib*la^2*mf + 2*Im*la^2*mf - 2*Im*la^2*mf*n + Im*la^2*mf*n^2 + Im*lb^2*mf*n^2)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, (lya*mb*(Im^2*la*mb*n^3 - Im^2*la*mb*n^2 - Im^2*la*lxb^2*mf*n^2 + Im^2*la*lxb^2*mf*n^3 - Im^2*la*lyb^2*mf*n^2 + Im^2*la*lyb^2*mf*n^3 - Im*la*lb^2*mb*mf*n + Im*la*lb^2*lxb^2*mf^2*n^2 + Im*la*lb^2*lyb^2*mf^2*n^2 + Ib*la^2*lb*lxa*lxb*mf^2 + Ib*la^2*lb*lya*lyb*mf^2 + 2*Im*la^2*lb*lxa*lxb*mf^2 + 2*Im*la^2*lb*lya*lyb*mf^2 + Im^2*lb*lxa*lxb*mf*n^2 - Im^2*lb*lxa*lxb*mf*n^3 + Im^2*lb*lya*lyb*mf*n^2 - Im^2*lb*lya*lyb*mf*n^3 + Im*la*lb^2*mb*mf*n^2 - Im*la*lb^2*lxb^2*mf^2*n - Im*la*lb^2*lyb^2*mf^2*n + Im*la^2*lb*lxa*lxb*mf^2*n^2 + Im*la^2*lb*lya*lyb*mf^2*n^2 + Ib*Im*lb*lxa*lxb*mf*n^2 + Ib*Im*lb*lya*lyb*mf*n^2 - 3*Im*la^2*lb*lxa*lxb*mf^2*n - 3*Im*la^2*lb*lya*lyb*mf^2*n))/Itot, -(lxa*mb*(Im^2*la*mb*n^3 - Im^2*la*mb*n^2 - Im^2*la*lxb^2*mf*n^2 + Im^2*la*lxb^2*mf*n^3 - Im^2*la*lyb^2*mf*n^2 + Im^2*la*lyb^2*mf*n^3 - Im*la*lb^2*mb*mf*n + Im*la*lb^2*lxb^2*mf^2*n^2 + Im*la*lb^2*lyb^2*mf^2*n^2 + Ib*la^2*lb*lxa*lxb*mf^2 + Ib*la^2*lb*lya*lyb*mf^2 + 2*Im*la^2*lb*lxa*lxb*mf^2 + 2*Im*la^2*lb*lya*lyb*mf^2 + Im^2*lb*lxa*lxb*mf*n^2 - Im^2*lb*lxa*lxb*mf*n^3 + Im^2*lb*lya*lyb*mf*n^2 - Im^2*lb*lya*lyb*mf*n^3 + Im*la*lb^2*mb*mf*n^2 - Im*la*lb^2*lxb^2*mf^2*n - Im*la*lb^2*lyb^2*mf^2*n + Im*la^2*lb*lxa*lxb*mf^2*n^2 + Im*la^2*lb*lya*lyb*mf^2*n^2 + Ib*Im*lb*lxa*lxb*mf*n^2 + Ib*Im*lb*lya*lyb*mf*n^2 - 3*Im*la^2*lb*lxa*lxb*mf^2*n - 3*Im*la^2*lb*lya*lyb*mf^2*n))/Itot, -(lyb*mb*(Im^2*lb*mb*n^2 - Im^2*lb*mb*n^3 + Ib*la^2*lb*lxa^2*mf^2 + Ib*la^2*lb*lya^2*mf^2 + 2*Im*la^2*lb*lxa^2*mf^2 + 2*Im*la^2*lb*lya^2*mf^2 + Im^2*lb*lxa^2*mf*n^2 - Im^2*lb*lxa^2*mf*n^3 + Im^2*lb*lya^2*mf*n^2 - Im^2*lb*lya^2*mf*n^3 + Ib*Im*lb*mb*n^2 + Ib*la^2*lb*mb*mf + 2*Im*la^2*lb*mb*mf - 3*Im*la^2*lb*mb*mf*n + Im*la^2*lb*lxa^2*mf^2*n^2 + Im*la^2*lb*lya^2*mf^2*n^2 + Ib*Im*lb*lxa^2*mf*n^2 + Ib*Im*lb*lya^2*mf*n^2 - Im^2*la*lxa*lxb*mf*n^2 + Im^2*la*lxa*lxb*mf*n^3 - Im^2*la*lya*lyb*mf*n^2 + Im^2*la*lya*lyb*mf*n^3 + Im*la^2*lb*mb*mf*n^2 - 3*Im*la^2*lb*lxa^2*mf^2*n - 3*Im*la^2*lb*lya^2*mf^2*n + Im*la*lb^2*lxa*lxb*mf^2*n^2 + Im*la*lb^2*lya*lyb*mf^2*n^2 - Im*la*lb^2*lxa*lxb*mf^2*n - Im*la*lb^2*lya*lyb*mf^2*n))/Itot, (lxb*mb*(Im^2*lb*mb*n^2 - Im^2*lb*mb*n^3 + Ib*la^2*lb*lxa^2*mf^2 + Ib*la^2*lb*lya^2*mf^2 + 2*Im*la^2*lb*lxa^2*mf^2 + 2*Im*la^2*lb*lya^2*mf^2 + Im^2*lb*lxa^2*mf*n^2 - Im^2*lb*lxa^2*mf*n^3 + Im^2*lb*lya^2*mf*n^2 - Im^2*lb*lya^2*mf*n^3 + Ib*Im*lb*mb*n^2 + Ib*la^2*lb*mb*mf + 2*Im*la^2*lb*mb*mf - 3*Im*la^2*lb*mb*mf*n + Im*la^2*lb*lxa^2*mf^2*n^2 + Im*la^2*lb*lya^2*mf^2*n^2 + Ib*Im*lb*lxa^2*mf*n^2 + Ib*Im*lb*lya^2*mf*n^2 - Im^2*la*lxa*lxb*mf*n^2 + Im^2*la*lxa*lxb*mf*n^3 - Im^2*la*lya*lyb*mf*n^2 + Im^2*la*lya*lyb*mf*n^3 + Im*la^2*lb*mb*mf*n^2 - 3*Im*la^2*lb*lxa^2*mf^2*n - 3*Im*la^2*lb*lya^2*mf^2*n + Im*la*lb^2*lxa*lxb*mf^2*n^2 + Im*la*lb^2*lya*lyb*mf^2*n^2 - Im*la*lb^2*lxa*lxb*mf^2*n - Im*la*lb^2*lya*lyb*mf^2*n))/Itot, -((Im*n + lb^2*mf)*(Im*n^2 + la^2*mf)*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2))/Itot, (Im^2*la*lxb^2*lya*mf^2*n^2 - Im^2*la*lxb^2*lya*mf^2*n^3 + Im^2*lb*lxa^2*lyb*mf^2*n^2 - Im^2*lb*lxa^2*lyb*mf^2*n^3 + Ib*la^2*lb*lyb*mb*mf^2 + 2*Im*la^2*lb*lyb*mb*mf^2 + Im^2*la*lya*mb*mf*n^2 - Im^2*la*lya*mb*mf*n^3 + Im^2*lb*lyb*mb*mf*n^2 - Im^2*lb*lyb*mb*mf*n^3 + Ib*la^2*lb*lxa^2*lyb*mf^3 + 2*Im*la^2*lb*lxa^2*lyb*mf^3 + Ib*Im*lb*lxa^2*lyb*mf^2*n^2 + Im*la*lb^2*lxb^2*lya*mf^3*n - 3*Im*la^2*lb*lxa^2*lyb*mf^3*n - Im^2*la*lxa*lxb*lyb*mf^2*n^2 + Im^2*la*lxa*lxb*lyb*mf^2*n^3 - Im^2*lb*lxa*lxb*lya*mf^2*n^2 + Im^2*lb*lxa*lxb*lya*mf^2*n^3 - Im*la*lb^2*lya*mb*mf^2*n^2 + Im*la^2*lb*lyb*mb*mf^2*n^2 + Ib*Im*lb*lyb*mb*mf*n^2 - Im*la*lb^2*lxb^2*lya*mf^3*n^2 + Im*la^2*lb*lxa^2*lyb*mf^3*n^2 - Ib*la^2*lb*lxa*lxb*lya*mf^3 - 2*Im*la^2*lb*lxa*lxb*lya*mf^3 + Im*la*lb^2*lya*mb*mf^2*n - 3*Im*la^2*lb*lyb*mb*mf^2*n - Ib*Im*lb*lxa*lxb*lya*mf^2*n^2 + 3*Im*la^2*lb*lxa*lxb*lya*mf^3*n - Im*la*lb^2*lxa*lxb*lyb*mf^3*n - Im*la^2*lb*lxa*lxb*lya*mf^3*n^2 + Im*la*lb^2*lxa*lxb*lyb*mf^3*n^2)/Itot, -(Im^2*la*lxa*lyb^2*mf^2*n^2 - Im^2*la*lxa*lyb^2*mf^2*n^3 + Im^2*lb*lxb*lya^2*mf^2*n^2 - Im^2*lb*lxb*lya^2*mf^2*n^3 + Ib*la^2*lb*lxb*mb*mf^2 + 2*Im*la^2*lb*lxb*mb*mf^2 + Im^2*la*lxa*mb*mf*n^2 - Im^2*la*lxa*mb*mf*n^3 + Im^2*lb*lxb*mb*mf*n^2 - Im^2*lb*lxb*mb*mf*n^3 + Ib*la^2*lb*lxb*lya^2*mf^3 + 2*Im*la^2*lb*lxb*lya^2*mf^3 + Ib*Im*lb*lxb*lya^2*mf^2*n^2 + Im*la*lb^2*lxa*lyb^2*mf^3*n - 3*Im*la^2*lb*lxb*lya^2*mf^3*n - Im^2*la*lxb*lya*lyb*mf^2*n^2 + Im^2*la*lxb*lya*lyb*mf^2*n^3 - Im^2*lb*lxa*lya*lyb*mf^2*n^2 + Im^2*lb*lxa*lya*lyb*mf^2*n^3 - Im*la*lb^2*lxa*mb*mf^2*n^2 + Im*la^2*lb*lxb*mb*mf^2*n^2 + Ib*Im*lb*lxb*mb*mf*n^2 - Im*la*lb^2*lxa*lyb^2*mf^3*n^2 + Im*la^2*lb*lxb*lya^2*mf^3*n^2 - Ib*la^2*lb*lxa*lya*lyb*mf^3 - 2*Im*la^2*lb*lxa*lya*lyb*mf^3 + Im*la*lb^2*lxa*mb*mf^2*n - 3*Im*la^2*lb*lxb*mb*mf^2*n - Ib*Im*lb*lxa*lya*lyb*mf^2*n^2 + 3*Im*la^2*lb*lxa*lya*lyb*mf^3*n - Im*la*lb^2*lxb*lya*lyb*mf^3*n - Im*la^2*lb*lxa*lya*lyb*mf^3*n^2 + Im*la*lb^2*lxb*lya*lyb*mf^3*n^2)/Itot]];

f0 = [[0];
      [0];
      [(n*(mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)*(Im^2*b*dthma*n^3 + Im^2*b*dthmb*n^3 + b*dthma*la^2*lb^2*mf^2 + b*dthmb*la^2*lb^2*mf^2 + Im*b*dthmb*la^2*mf*n + Im*b*dthma*lb^2*mf*n + Im*b*dthma*la^2*mf*n^2 + Im*b*dthmb*lb^2*mf*n^2 + 2*Im*dla*dthb*la*lb^2*mf^2 + 2*Im*dla*dthla*la*lb^2*mf^2 + 2*Im*dlb*dthb*la^2*lb*mf^2 + 2*Im*dlb*dthlb*la^2*lb*mf^2 + 2*Im^2*dla*dthb*la*mf*n^2 - 2*Im^2*dla*dthb*la*mf*n^3 + 2*Im^2*dla*dthla*la*mf*n^2 - 2*Im^2*dla*dthla*la*mf*n^3 + 2*Im^2*dlb*dthb*lb*mf*n^2 - 2*Im^2*dlb*dthb*lb*mf*n^3 + 2*Im^2*dlb*dthlb*lb*mf*n^2 - 2*Im^2*dlb*dthlb*lb*mf*n^3 - 2*Im*dla*dthb*la*lb^2*mf^2*n - 2*Im*dla*dthla*la*lb^2*mf^2*n - 2*Im*dlb*dthb*la^2*lb*mf^2*n - 2*Im*dlb*dthlb*la^2*lb*mf^2*n))/Itot];
      [la*(dthb + dthla)^2];
      [-((mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)*(Im^2*b*dthma*n^3 + Im^2*b*dthmb*n^3 + Ib*Im*b*dthma*n^3 + Ib*b*dthma*lb^2*mf*n + 2*Im*b*dthma*lb^2*mf*n + Im*b*dthma*la^2*mf*n^3 + Im*b*dthmb*la^2*mf*n^2 - 2*Im*b*dthma*lb^2*mf*n^2 + Im*b*dthma*lb^2*mf*n^3 + Im*b*dthmb*lb^2*mf*n^2 + 2*Ib*dla*dthb*la*lb^2*mf^2 + 2*Ib*dla*dthla*la*lb^2*mf^2 + 4*Im*dla*dthb*la*lb^2*mf^2 + 4*Im*dla*dthla*la*lb^2*mf^2 + 2*Im^2*dla*dthb*la*mf*n^2 - 2*Im^2*dla*dthb*la*mf*n^3 + 2*Im^2*dla*dthla*la*mf*n^2 - 2*Im^2*dla*dthla*la*mf*n^3 + 2*Im^2*dlb*dthb*lb*mf*n^2 - 2*Im^2*dlb*dthb*lb*mf*n^3 + 2*Im^2*dlb*dthlb*lb*mf*n^2 - 2*Im^2*dlb*dthlb*lb*mf*n^3 + b*dthma*la^2*lb^2*mf^2*n + b*dthmb*la^2*lb^2*mf^2*n + 2*Im*dla*dthb*la*lb^2*mf^2*n^2 + 2*Im*dla*dthla*la*lb^2*mf^2*n^2 - 2*Im*dlb*dthb*la^2*lb*mf^2*n^2 - 2*Im*dlb*dthlb*la^2*lb*mf^2*n^2 + 2*Ib*Im*dla*dthb*la*mf*n^2 + 2*Ib*Im*dla*dthla*la*mf*n^2 - 6*Im*dla*dthb*la*lb^2*mf^2*n - 6*Im*dla*dthla*la*lb^2*mf^2*n + 2*Im*dlb*dthb*la^2*lb*mf^2*n + 2*Im*dlb*dthlb*la^2*lb*mf^2*n))/Itot];
      [lb*(dthb + dthlb)^2];
      [-((mb^2 + lxa^2*mb*mf + lxb^2*mb*mf + lya^2*mb*mf + lyb^2*mb*mf + lxa^2*lyb^2*mf^2 + lxb^2*lya^2*mf^2 - 2*lxa*lxb*lya*lyb*mf^2)*(Im^2*b*dthma*n^3 + Im^2*b*dthmb*n^3 + Ib*Im*b*dthmb*n^3 + Ib*b*dthmb*la^2*mf*n + 2*Im*b*dthmb*la^2*mf*n + Im*b*dthma*la^2*mf*n^2 - 2*Im*b*dthmb*la^2*mf*n^2 + Im*b*dthmb*la^2*mf*n^3 + Im*b*dthma*lb^2*mf*n^2 + Im*b*dthmb*lb^2*mf*n^3 + 2*Ib*dlb*dthb*la^2*lb*mf^2 + 2*Ib*dlb*dthlb*la^2*lb*mf^2 + 4*Im*dlb*dthb*la^2*lb*mf^2 + 4*Im*dlb*dthlb*la^2*lb*mf^2 + 2*Im^2*dla*dthb*la*mf*n^2 - 2*Im^2*dla*dthb*la*mf*n^3 + 2*Im^2*dla*dthla*la*mf*n^2 - 2*Im^2*dla*dthla*la*mf*n^3 + 2*Im^2*dlb*dthb*lb*mf*n^2 - 2*Im^2*dlb*dthb*lb*mf*n^3 + 2*Im^2*dlb*dthlb*lb*mf*n^2 - 2*Im^2*dlb*dthlb*lb*mf*n^3 + b*dthma*la^2*lb^2*mf^2*n + b*dthmb*la^2*lb^2*mf^2*n - 2*Im*dla*dthb*la*lb^2*mf^2*n^2 - 2*Im*dla*dthla*la*lb^2*mf^2*n^2 + 2*Im*dlb*dthb*la^2*lb*mf^2*n^2 + 2*Im*dlb*dthlb*la^2*lb*mf^2*n^2 + 2*Ib*Im*dlb*dthb*lb*mf*n^2 + 2*Ib*Im*dlb*dthlb*lb*mf*n^2 + 2*Im*dla*dthb*la*lb^2*mf^2*n + 2*Im*dla*dthla*la*lb^2*mf^2*n - 6*Im*dlb*dthb*la^2*lb*mf^2*n - 6*Im*dlb*dthlb*la^2*lb*mf^2*n))/Itot]];
